---
  - name: FTP Install
    hosts: ubuntu

    tasks:
    - name: vsftp installation
      apt:
        name: vsftpd
        state: latest
        update_cache: yes
  
    - name: stop firewall
      service:
        name: ufw
        state: stopped
        enabled: no

    - name: Create ken user
      user:
        name: ken
        password: $5$rWW0p3wuQLr1qz9f$8maUgCP/sOU6yc9yipMhLhs4t8YCgXCNkD5QqLqkPM2
        comment: "Kenneth Pajadura"

    - name: Adding DenyUsers
      lineinfile:
        path: /etc/ssh/sshd_config
        line: "DenyUsers ken"
      register: sshd_config

    - name: Restart sshd
      service:
        name: sshd
        state: restarted
      when: sshd_config.changed

    - name: Create ftp directory
      file:
        path: /home/ken
        state: directory
        owner: nobody
        group: nogroup
        mode: '0555'
      
    - name: Creating Files Directory
      file:
        path: /home/ken/files
        state: directory
        owner: ken
        group: ken

    - name: vsftpd.conf
      copy:
        src: vsftpd.conf
        dest: /etc/vsftpd.conf
      register: vsftpd_config

    - name: Restarting
      service:
        name: vsftpd
        state: restarted
      when: vsftpd_config.changed

